<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã½ã£ã·ãã™ ã“ãƒ¼ã²ãƒ¼ ã‚‰ã¼ â€” Revenue Simulation</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root {
    --color-navy: #243668;
    --color-pink: #ff9fb4;
    --color-cyan: #7af2e0;
    --color-bg: #fcfcfc;
    --color-text: #4b3e3c;
    --font-heading: 'Montserrat', 'Noto Sans JP', sans-serif;
    --font-body: 'Noto Sans JP', sans-serif;
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: var(--font-body);
    background: var(--color-bg);
    color: var(--color-text);
    letter-spacing: 0.05em;
    font-feature-settings: "palt" 1;
    padding-top: 80px;
}

header {
    background: #fff;
    color: var(--color-text);
    padding: 20px 0;
    text-align: center;
    border-bottom: 1px solid rgba(0,0,0,0.08);
    box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 1000;
}
header h1 { font-family: var(--font-heading); font-size: 24px; font-weight: 800; letter-spacing: 0.15em; color: var(--color-navy); }
header p { font-size: 13px; opacity: 0.7; margin-top: 4px; }
header .hub-link {
    position: absolute;
    left: 24px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 12px;
    color: var(--color-navy);
    text-decoration: none;
    border: 1px solid rgba(36, 54, 104, 0.3);
    padding: 6px 12px;
    border-radius: 100vh;
    transition: all 0.2s;
}
header .hub-link:hover {
    background: rgba(36, 54, 104, 0.05);
    border-color: var(--color-navy);
}

.container { max-width: 1200px; margin: 0 auto; padding: 24px 16px; }

/* Dialogue */
.dialogue-section { margin-bottom: 32px; }
.dialogue-title {
    font-family: var(--font-heading); font-size: 16px; font-weight: 700;
    color: var(--color-navy); margin-bottom: 16px; padding-bottom: 8px;
    border-bottom: 2px solid var(--color-cyan);
}
.msg { display: flex; gap: 12px; margin-bottom: 16px; align-items: flex-start; }
.msg-left .avatar { background: var(--color-navy); }
.msg-right { flex-direction: row-reverse; }
.msg-right .avatar { background: #e74c3c; }
.msg-right .bubble { background: #fef3f3; border-color: #f5c6c6; }
.avatar {
    width: 36px; height: 36px; border-radius: 50%; color: white;
    display: flex; align-items: center; justify-content: center;
    font-family: var(--font-heading); font-size: 11px; font-weight: 700;
    flex-shrink: 0;
}
.bubble {
    background: #f0f4ff; border: 1px solid #d0daef; border-radius: 12px;
    padding: 12px 16px; max-width: 80%; font-size: 14px; line-height: 1.7;
}
.bubble strong { color: var(--color-navy); }
.bubble .highlight { background: rgba(122,242,224,0.2); padding: 1px 4px; border-radius: 3px; font-weight: 600; }

/* Cards */
.sim-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 24px; }
.sim-card {
    background: white;
    border-radius: 16px;
    padding: 24px;
    border: 1px solid rgba(0,0,0,0.08);
    box-shadow: none;
}
.sim-card h3 {
    font-family: var(--font-heading); font-size: 13px; font-weight: 700;
    color: var(--color-navy); letter-spacing: 0.08em; text-transform: uppercase;
    margin-bottom: 16px;
}
.cost-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f0f0f0; font-size: 14px; }
.cost-row:last-child { border-bottom: none; }
.cost-label { color: #666; }
.cost-value { font-weight: 700; color: var(--color-navy); }
.cost-value.red { color: #e74c3c; }
.cost-value.green { color: #059669; }
.cost-total { background: #f8f9fc; margin: 12px -24px -24px; padding: 16px 24px; border-radius: 0 0 16px 16px; }
.cost-total .cost-row { border: none; font-size: 16px; }

/* Slider controls */
.control-group { margin-bottom: 16px; }
.control-label { font-size: 12px; font-weight: 600; color: #666; margin-bottom: 6px; display: flex; justify-content: space-between; }
.control-val { color: var(--color-navy); font-size: 14px; font-weight: 700; }
input[type="range"] {
    width: 100%; height: 6px; -webkit-appearance: none; appearance: none;
    background: #e0e0e0; border-radius: 3px; outline: none;
}
input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%;
    background: var(--color-navy); cursor: pointer; border: 3px solid white;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

/* Result highlight */
.result-banner {
    background: linear-gradient(135deg, var(--color-navy), #1a284d);
    color: white; border-radius: 16px; padding: 32px;
    text-align: center; margin: 24px 0;
}
.result-banner h2 { font-family: var(--font-heading); font-size: 14px; letter-spacing: 0.1em; opacity: 0.8; margin-bottom: 8px; }
.result-big { font-family: var(--font-heading); font-size: 42px; font-weight: 800; }
.result-big.positive { color: var(--color-cyan); }
.result-big.negative { color: var(--color-pink); }
.result-sub { font-size: 13px; opacity: 0.7; margin-top: 8px; }
.result-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 24px; }
.result-item { text-align: center; }
.result-item .ri-val { font-family: var(--font-heading); font-size: 22px; font-weight: 700; }
.result-item .ri-label { font-size: 11px; opacity: 0.6; margin-top: 2px; }

/* Plan cards */
.plan-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
.plan-card {
    background: white;
    border-radius: 16px;
    padding: 24px;
    position: relative;
    border: 1px solid rgba(0,0,0,0.08);
    transition: all 0.2s;
}
.plan-card.recommended { border: 1px solid var(--color-cyan); }
.plan-card.recommended::before {
    content: 'â˜… RECOMMENDED';
    position: absolute;
    top: -12px;
    left: 20px;
    background: var(--color-cyan);
    color: var(--color-navy);
    padding: 4px 16px;
    border-radius: 100vh;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.1em;
}
.plan-name { font-family: var(--font-heading); font-size: 18px; font-weight: 800; color: var(--color-navy); margin-bottom: 4px; }
.plan-sub { font-size: 12px; color: #999; margin-bottom: 16px; }
.plan-stat { display: flex; justify-content: space-between; padding: 6px 0; font-size: 13px; }
.plan-stat-val { font-weight: 700; }
.plan-divider { height: 1px; background: #f0f0f0; margin: 12px 0; }
.plan-profit { font-family: var(--font-heading); font-size: 24px; font-weight: 800; text-align: center; padding: 12px 0; }
.plan-profit.positive { color: #059669; }
.plan-profit.negative { color: #e74c3c; }

/* Scenario table */
.scenario-table { width: 100%; border-collapse: collapse; font-size: 13px; }
.scenario-table th {
    background: #fafafa;
    color: var(--color-text);
    padding: 10px 12px;
    text-align: left;
    font-family: var(--font-heading);
    font-size: 11px;
    letter-spacing: 0.05em;
    border-bottom: 1px solid rgba(0,0,0,0.08);
    font-weight: 600;
}
.scenario-table td { padding: 10px 12px; border-bottom: 1px solid rgba(0,0,0,0.06); color: var(--color-text); }
.scenario-table tr:hover td { background: rgba(0,0,0,0.02); }

.section-gap { height: 40px; }
</style>
</head>
<body>

<header>
    <a href="./08_POPX_Coffee_Hub.html" class="hub-link">â† Hub</a>
    <h1>ã½ã£ã·ãã™ ã“ãƒ¼ã²ãƒ¼ ã‚‰ã¼ â€” Revenue Simulation</h1>
    <p>POPX Coffee Project â€” Business Model Analysis</p>
</header>

<div class="container">

    <!-- CEO Ã— CFO Dialogue -->
    <div class="dialogue-section">
        <div class="dialogue-title">ğŸ’¬ CEO Ã— CFO Business Discussion</div>

        <div class="msg msg-left">
            <div class="avatar">CEO</div>
            <div class="bubble">ã¾ãšç¾çŠ¶ã®æ•°å­—ã‚’æ•´ç†ã—ã‚ˆã†ã€‚ä»Šæ‰‹å…ƒã«ã‚ã‚‹48ç¨®ã®è±†ã€è³¼å…¥ç·é¡ã¯<strong>Â¥250,482</strong>ã§ã€15g/æ¯ã§æ·¹ã‚Œã‚‹ã¨<strong>ç´„496æ¯</strong>åˆ†ã€‚1æ¯ã‚ãŸã‚Šã®è±†åŸä¾¡ã¯ä¸­å¤®å€¤ã§<strong>Â¥450</strong>ã€å¹³å‡<strong>Â¥635</strong>ã€‚çµæ§‹å¹…ãŒã‚ã‚‹ã­ã€‚</div>
        </div>

        <div class="msg msg-right">
            <div class="avatar">CFO</div>
            <div class="bubble">è±†åŸä¾¡ã ã‘ã˜ã‚ƒãªãã¦ã€å›ºå®šè²»ãŒã‹ãªã‚Šã‚ã‚‹ã€‚æœˆã®å›ºå®šè²»ã‚’æ•´ç†ã™ã‚‹ã¨ï¼š<br>
            ãƒ»å®¶è³ƒ+å…‰ç†±è²»: <strong>Â¥150,000</strong><br>
            ãƒ»é€æ–™ãƒ»é–¢ç¨: <strong>Â¥10,000</strong>/è¼¸å…¥ Ã— æœˆ2ã€œ3å›<br>
            ãƒ»æ¶ˆè€—å“ï¼ˆãƒ‰ãƒªãƒƒãƒ‘ãƒ¼ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç­‰ï¼‰: <strong>Â¥30,000</strong><br>
            ãƒ»äºˆå‚™è²»: <strong>Â¥100,000</strong><br>
            ãƒãƒªã‚¹ã‚¿ä»£ã¯<strong>Â¥1,600/h</strong>ã®å¤‰å‹•è²»ã€‚1æ¯æ·¹ã‚Œã‚‹ã®ã«10åˆ†ã¨ã—ã¦ã€<strong>Â¥267/æ¯</strong>ã€‚</div>
        </div>

        <div class="msg msg-left">
            <div class="avatar">CEO</div>
            <div class="bubble">ã¤ã¾ã‚Šå›ºå®šè²»ã ã‘ã§æœˆ<strong>Â¥300,000ã€œ310,000</strong>ã€‚ã“ã‚Œã‚’å£²ä¸Šã§ã‚«ãƒãƒ¼ã—ãªã„ã¨ã„ã‘ãªã„ã€‚<br><br>
            ã§ã‚‚åƒ•ã‚‰ã¯ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ†ã‚£ã‚³ãƒ¼ãƒ’ãƒ¼ã®ãƒã‚¤ã‚¨ãƒ³ãƒ‰è·¯ç·šã€‚é‡ã§å‹è² ã˜ã‚ƒãªãã¦<span class="highlight">ä½“é¨“ã®ä¾¡å€¤</span>ã§å‹è² ã—ãŸã„ã€‚1æ—¥ä½•æ¯ãã‚‰ã„ãŒç¾å®Ÿçš„ï¼Ÿ</div>
        </div>

        <div class="msg msg-right">
            <div class="avatar">CFO</div>
            <div class="bubble">ãƒãƒªã‚¹ã‚¿1äººã§1æ¯10åˆ†ãªã‚‰ã€<strong>1æ—¥6hç¨¼åƒã§æœ€å¤§36æ¯</strong>ã€‚ç¾å®Ÿçš„ã«ã¯ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å«ã‚ã¦<strong>1æ—¥15ã€œ25æ¯</strong>ãŒå¦¥å½“ã€‚<br><br>
            å–¶æ¥­æ—¥æ•°ã‚’æœˆ22æ—¥ã¨ã™ã‚‹ã¨ã€æœˆ<strong>330ã€œ550æ¯</strong>ã€‚æç›Šåˆ†å²ã‚’é€†ç®—ã™ã‚‹ã¨â€¦</div>
        </div>

        <div class="msg msg-left">
            <div class="avatar">CEO</div>
            <div class="bubble">å£²å€¤ã®ãƒ¬ãƒ³ã‚¸ã‚’è€ƒãˆã‚‹ã¨ã€ã†ã¡ã®è±†ã¯3ã¤ã®ä¾¡æ ¼å¸¯ã«åˆ†ã‘ã‚‰ã‚Œãã†ï¼š<br>
            ãƒ»<strong>Standard</strong>ï¼ˆã€œÂ¥500åŸä¾¡ï¼‰â†’ å£²å€¤Â¥1,200ã€œ1,800<br>
            ãƒ»<strong>Premium</strong>ï¼ˆÂ¥500ã€œ1,000åŸä¾¡ï¼‰â†’ å£²å€¤Â¥2,500ã€œ4,000<br>
            ãƒ»<strong>Legendary</strong>ï¼ˆÂ¥1,000+åŸä¾¡ï¼‰â†’ å£²å€¤Â¥5,000ã€œ8,000<br><br>
            ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹æˆã§ç²—åˆ©ç‡ã‚’ãƒŸãƒƒã‚¯ã‚¹ã—ã¦ã„ãã®ãŒãƒã‚¤ãƒ³ãƒˆã ã­ã€‚</div>
        </div>

        <div class="msg msg-right">
            <div class="avatar">CFO</div>
            <div class="bubble">ãã†ã€‚<strong>å£²ä¸ŠãƒŸãƒƒã‚¯ã‚¹</strong>ãŒéµã€‚ä»®ã«1æ—¥20æ¯ã¨ã—ã¦ï¼š<br>
            ãƒ»Standard 12æ¯ Ã— Â¥1,500 = Â¥18,000<br>
            ãƒ»Premium 6æ¯ Ã— Â¥3,000 = Â¥18,000<br>
            ãƒ»Legendary 2æ¯ Ã— Â¥6,000 = Â¥12,000<br>
            â†’ <strong>æ—¥å•†Â¥48,000</strong>ã€æœˆ22æ—¥ã§<strong>Â¥1,056,000</strong>ã€‚<br><br>
            ã“ã‚Œãªã‚‰å›ºå®šè²»+å¤‰å‹•è²»ã‚’å¼•ã„ã¦ã‚‚åˆ©ç›ŠãŒæ®‹ã‚‹ã€‚ä¸‹ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§è©¦ã—ã¦ã¿ã‚ˆã†ã€‚</div>
        </div>
    </div>

    <!-- FIXED COSTS -->
    <div class="sim-grid">
        <div class="sim-card">
            <h3>ğŸ“‹ Monthly Fixed Costs</h3>
            <div class="cost-row"><span class="cost-label">å®¶è³ƒ + å…‰ç†±è²»</span><span class="cost-value">Â¥150,000</span></div>
            <div class="cost-row"><span class="cost-label">é€æ–™ãƒ»é–¢ç¨ (æœˆ2.5å›)</span><span class="cost-value">Â¥25,000</span></div>
            <div class="cost-row"><span class="cost-label">æ¶ˆè€—å“ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç­‰ï¼‰</span><span class="cost-value">Â¥30,000</span></div>
            <div class="cost-row"><span class="cost-label">äºˆå‚™è²»</span><span class="cost-value">Â¥100,000</span></div>
            <div class="cost-total">
                <div class="cost-row"><span class="cost-label">æœˆé–“å›ºå®šè²» åˆè¨ˆ</span><span class="cost-value red">Â¥305,000</span></div>
            </div>
        </div>

        <div class="sim-card">
            <h3>â± Variable Costs (per cup)</h3>
            <div class="cost-row"><span class="cost-label">ãƒãƒªã‚¹ã‚¿ä»£ (Â¥1,600/h Ã— 10min)</span><span class="cost-value">Â¥267</span></div>
            <div class="cost-row"><span class="cost-label">è±†åŸä¾¡ (ä¸­å¤®å€¤ 15g)</span><span class="cost-value">Â¥450</span></div>
            <div class="cost-row"><span class="cost-label">æ°´ãƒ»ã‚«ãƒƒãƒ—ç­‰</span><span class="cost-value">Â¥50</span></div>
            <div class="cost-total">
                <div class="cost-row"><span class="cost-label">1æ¯ã‚ãŸã‚Šå¤‰å‹•è²» (ç›®å®‰)</span><span class="cost-value red">Â¥767</span></div>
            </div>
        </div>
    </div>

    <!-- INTERACTIVE SIMULATOR -->
    <div class="sim-card" style="margin-bottom:24px;">
        <h3>ğŸ› Interactive Simulator</h3>
        <div class="sim-grid" style="margin-bottom:0;">
            <div>
                <div class="control-group">
                    <div class="control-label"><span>Standardæ¯æ•° / æ—¥</span><span class="control-val" id="v-std">12</span></div>
                    <input type="range" id="s-std" min="0" max="30" value="12" oninput="calc()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>Standard å£²å€¤</span><span class="control-val" id="v-std-price">Â¥1,500</span></div>
                    <input type="range" id="s-std-price" min="800" max="2500" step="50" value="1500" oninput="calc()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>Standard è±†åŸä¾¡</span><span class="control-val" id="v-std-cost">Â¥300</span></div>
                    <input type="range" id="s-std-cost" min="100" max="600" step="10" value="300" oninput="calc()">
                </div>
            </div>
            <div>
                <div class="control-group">
                    <div class="control-label"><span>Premiumæ¯æ•° / æ—¥</span><span class="control-val" id="v-prm">6</span></div>
                    <input type="range" id="s-prm" min="0" max="20" value="6" oninput="calc()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>Premium å£²å€¤</span><span class="control-val" id="v-prm-price">Â¥3,000</span></div>
                    <input type="range" id="s-prm-price" min="1500" max="5000" step="100" value="3000" oninput="calc()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>Premium è±†åŸä¾¡</span><span class="control-val" id="v-prm-cost">Â¥700</span></div>
                    <input type="range" id="s-prm-cost" min="300" max="1200" step="10" value="700" oninput="calc()">
                </div>
            </div>
            <div>
                <div class="control-group">
                    <div class="control-label"><span>Legendaryæ¯æ•° / æ—¥</span><span class="control-val" id="v-leg">2</span></div>
                    <input type="range" id="s-leg" min="0" max="10" value="2" oninput="calc()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>Legendary å£²å€¤</span><span class="control-val" id="v-leg-price">Â¥6,000</span></div>
                    <input type="range" id="s-leg-price" min="3000" max="8000" step="100" value="6000" oninput="calc()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>Legendary è±†åŸä¾¡</span><span class="control-val" id="v-leg-cost">Â¥1,500</span></div>
                    <input type="range" id="s-leg-cost" min="800" max="3000" step="50" value="1500" oninput="calc()">
                </div>
            </div>
        </div>
        <div style="margin-top:16px;">
            <div class="control-group">
                <div class="control-label"><span>å–¶æ¥­æ—¥æ•° / æœˆ</span><span class="control-val" id="v-days">22</span></div>
                <input type="range" id="s-days" min="10" max="30" value="22" oninput="calc()">
            </div>
            <div class="control-group">
                <div class="control-label"><span>ãƒãƒªã‚¹ã‚¿ç¨¼åƒæ™‚é–“ / æ—¥</span><span class="control-val" id="v-hours">6</span></div>
                <input type="range" id="s-hours" min="3" max="10" value="6" oninput="calc()">
            </div>
        </div>
    </div>

    <!-- RESULT BANNER -->
    <div class="result-banner" id="result-banner">
        <h2>MONTHLY PROFIT</h2>
        <div class="result-big positive" id="r-profit">Â¥0</div>
        <div class="result-sub" id="r-profit-sub"></div>
        <div class="result-grid">
            <div class="result-item"><div class="ri-val" id="r-revenue">Â¥0</div><div class="ri-label">æœˆé–“å£²ä¸Š</div></div>
            <div class="result-item"><div class="ri-val" id="r-cost">Â¥0</div><div class="ri-label">æœˆé–“ç·ã‚³ã‚¹ãƒˆ</div></div>
            <div class="result-item"><div class="ri-val" id="r-margin">0%</div><div class="ri-label">å–¶æ¥­åˆ©ç›Šç‡</div></div>
        </div>
        <div class="result-grid" style="margin-top:16px;">
            <div class="result-item"><div class="ri-val" id="r-cups">0</div><div class="ri-label">æœˆé–“æ¯æ•°</div></div>
            <div class="result-item"><div class="ri-val" id="r-avg-price">Â¥0</div><div class="ri-label">å¹³å‡å®¢å˜ä¾¡</div></div>
            <div class="result-item"><div class="ri-val" id="r-bep">0æ¯</div><div class="ri-label">æç›Šåˆ†å²æ¯æ•°/æœˆ</div></div>
        </div>
    </div>

    <!-- CEO CFO CONCLUSION -->
    <div class="dialogue-section">
        <div class="dialogue-title">ğŸ“Š 3 Plans â€” CEO Ã— CFO Recommendation</div>

        <div class="msg msg-left">
            <div class="avatar">CEO</div>
            <div class="bubble">3ã¤ã®ãƒ—ãƒ©ãƒ³ã‚’æ¯”è¼ƒã—ã‚ˆã†ã€‚ãƒ–ãƒ©ãƒ³ãƒ‰ã®ä¸–ç•Œè¦³ã‚’å¤§äº‹ã«ã—ãªãŒã‚‰ã€ãƒ“ã‚¸ãƒã‚¹ã¨ã—ã¦ã‚‚æˆã‚Šç«‹ã¤æœ€é©è§£ã‚’è¦‹ã¤ã‘ãŸã„ã€‚</div>
        </div>
    </div>

    <div class="plan-grid" id="plan-grid"></div>

    <div class="dialogue-section">
        <div class="msg msg-right">
            <div class="avatar">CFO</div>
            <div class="bubble" id="cfo-conclusion"></div>
        </div>
        <div class="msg msg-left">
            <div class="avatar">CEO</div>
            <div class="bubble" id="ceo-conclusion"></div>
        </div>
    </div>

    <!-- DETAIL TABLE -->
    <div class="sim-card" style="margin-top:24px;">
        <h3>ğŸ“‹ Monthly P&L Breakdown</h3>
        <div style="overflow-x:auto;">
            <table class="scenario-table" id="pl-table"></table>
        </div>
    </div>

    <!-- Annual Projection -->
    <div class="sim-card" style="margin-top:20px;">
        <h3>ğŸ“ˆ 12-Month Projection (Recommended Plan)</h3>
        <div style="overflow-x:auto;">
            <table class="scenario-table" id="annual-table"></table>
        </div>
    </div>

</div>

<script>
const FIXED_COSTS = {
    rent: 150000,
    shipping: 25000,
    consumables: 30000,
    reserve: 100000
};
const FIXED_TOTAL = Object.values(FIXED_COSTS).reduce((a,b) => a+b, 0);
const BARISTA_RATE = 1600; // per hour
const MISC_PER_CUP = 50; // water, cup, etc.

function fmt(n) { return 'Â¥' + Math.round(n).toLocaleString(); }

function calc() {
    const std = +document.getElementById('s-std').value;
    const stdPrice = +document.getElementById('s-std-price').value;
    const stdCost = +document.getElementById('s-std-cost').value;
    const prm = +document.getElementById('s-prm').value;
    const prmPrice = +document.getElementById('s-prm-price').value;
    const prmCost = +document.getElementById('s-prm-cost').value;
    const leg = +document.getElementById('s-leg').value;
    const legPrice = +document.getElementById('s-leg-price').value;
    const legCost = +document.getElementById('s-leg-cost').value;
    const days = +document.getElementById('s-days').value;
    const hours = +document.getElementById('s-hours').value;

    // Update displays
    document.getElementById('v-std').textContent = std;
    document.getElementById('v-std-price').textContent = fmt(stdPrice);
    document.getElementById('v-std-cost').textContent = fmt(stdCost);
    document.getElementById('v-prm').textContent = prm;
    document.getElementById('v-prm-price').textContent = fmt(prmPrice);
    document.getElementById('v-prm-cost').textContent = fmt(prmCost);
    document.getElementById('v-leg').textContent = leg;
    document.getElementById('v-leg-price').textContent = fmt(legPrice);
    document.getElementById('v-leg-cost').textContent = fmt(legCost);
    document.getElementById('v-days').textContent = days;
    document.getElementById('v-hours').textContent = hours + 'h';

    const cupsDay = std + prm + leg;
    const cupsMonth = cupsDay * days;

    // Revenue
    const dailyRev = std * stdPrice + prm * prmPrice + leg * legPrice;
    const monthlyRev = dailyRev * days;

    // Bean cost
    const dailyBeanCost = std * stdCost + prm * prmCost + leg * legCost;
    const monthlyBeanCost = dailyBeanCost * days;

    // Barista
    const monthlyBarista = hours * BARISTA_RATE * days;

    // Misc
    const monthlyMisc = cupsMonth * MISC_PER_CUP;

    // Total cost
    const totalCost = FIXED_TOTAL + monthlyBeanCost + monthlyBarista + monthlyMisc;
    const profit = monthlyRev - totalCost;
    const margin = monthlyRev > 0 ? (profit / monthlyRev * 100) : 0;
    const avgPrice = cupsMonth > 0 ? monthlyRev / cupsMonth : 0;

    // Break-even
    const avgVarCost = cupsMonth > 0 ? (monthlyBeanCost + monthlyMisc) / cupsMonth + (BARISTA_RATE * hours / cupsDay) : 0;
    const bep = avgPrice > avgVarCost ? Math.ceil(FIXED_TOTAL / (avgPrice - avgVarCost)) : 9999;

    // Update results
    const profitEl = document.getElementById('r-profit');
    profitEl.textContent = fmt(profit);
    profitEl.className = 'result-big ' + (profit >= 0 ? 'positive' : 'negative');
    document.getElementById('r-profit-sub').textContent = profit >= 0
        ? `æœˆé–“${cupsMonth}æ¯ã§é»’å­—é”æˆï¼`
        : `ã‚ã¨${bep - cupsMonth > 0 ? bep - cupsMonth : '?'}æ¯ã§æç›Šåˆ†å²`;
    document.getElementById('r-revenue').textContent = fmt(monthlyRev);
    document.getElementById('r-cost').textContent = fmt(totalCost);
    document.getElementById('r-margin').textContent = margin.toFixed(1) + '%';
    document.getElementById('r-cups').textContent = cupsMonth;
    document.getElementById('r-avg-price').textContent = fmt(avgPrice);
    document.getElementById('r-bep').textContent = bep + 'æ¯';

    // P&L table
    document.getElementById('pl-table').innerHTML = `
        <thead><tr><th>é …ç›®</th><th>é‡‘é¡</th><th>æ§‹æˆæ¯”</th></tr></thead>
        <tbody>
            <tr><td><strong>å£²ä¸Š</strong></td><td style="color:#059669;font-weight:700;">${fmt(monthlyRev)}</td><td>100%</td></tr>
            <tr><td>ã€€Standard (${std}æ¯/æ—¥ Ã— ${days}æ—¥)</td><td>${fmt(std * stdPrice * days)}</td><td>${(std*stdPrice*days/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td>ã€€Premium (${prm}æ¯/æ—¥ Ã— ${days}æ—¥)</td><td>${fmt(prm * prmPrice * days)}</td><td>${(prm*prmPrice*days/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td>ã€€Legendary (${leg}æ¯/æ—¥ Ã— ${days}æ—¥)</td><td>${fmt(leg * legPrice * days)}</td><td>${(leg*legPrice*days/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td colspan="3" style="height:8px;border:none;"></td></tr>
            <tr><td><strong>å¤‰å‹•è²»</strong></td><td style="color:#e74c3c;">${fmt(monthlyBeanCost + monthlyBarista + monthlyMisc)}</td><td>${((monthlyBeanCost+monthlyBarista+monthlyMisc)/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td>ã€€è±†åŸä¾¡</td><td>${fmt(monthlyBeanCost)}</td><td>${(monthlyBeanCost/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td>ã€€ãƒãƒªã‚¹ã‚¿ä»£ (${hours}h Ã— ${days}æ—¥ Ã— Â¥1,600)</td><td>${fmt(monthlyBarista)}</td><td>${(monthlyBarista/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td>ã€€æ°´ãƒ»ã‚«ãƒƒãƒ—ç­‰</td><td>${fmt(monthlyMisc)}</td><td>${(monthlyMisc/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td colspan="3" style="height:8px;border:none;"></td></tr>
            <tr><td><strong>å›ºå®šè²»</strong></td><td style="color:#e74c3c;">${fmt(FIXED_TOTAL)}</td><td>${(FIXED_TOTAL/monthlyRev*100||0).toFixed(1)}%</td></tr>
            <tr><td>ã€€å®¶è³ƒ+å…‰ç†±è²»</td><td>${fmt(FIXED_COSTS.rent)}</td><td></td></tr>
            <tr><td>ã€€é€æ–™ãƒ»é–¢ç¨</td><td>${fmt(FIXED_COSTS.shipping)}</td><td></td></tr>
            <tr><td>ã€€æ¶ˆè€—å“</td><td>${fmt(FIXED_COSTS.consumables)}</td><td></td></tr>
            <tr><td>ã€€äºˆå‚™è²»</td><td>${fmt(FIXED_COSTS.reserve)}</td><td></td></tr>
            <tr style="background:#f8f9fc;"><td><strong>å–¶æ¥­åˆ©ç›Š</strong></td><td style="font-weight:800;color:${profit>=0?'#059669':'#e74c3c'};">${fmt(profit)}</td><td style="font-weight:700;">${margin.toFixed(1)}%</td></tr>
        </tbody>
    `;

    // Plans
    renderPlans(days);
    renderAnnual(days);
}

function renderPlans(days) {
    const plans = [
        {
            name: 'Conservative',
            sub: 'å°‘æ•°ç²¾é‹­ãƒ»ä½ãƒªã‚¹ã‚¯',
            std: 8, stdPrice: 1500, stdCost: 300,
            prm: 4, prmPrice: 2800, prmCost: 650,
            leg: 1, legPrice: 5500, legCost: 1300,
            hours: 5, recommended: false
        },
        {
            name: 'Balanced',
            sub: 'ä½“é¨“é‡è¦–ãƒ»å®‰å®šæˆé•·',
            std: 12, stdPrice: 1500, stdCost: 300,
            prm: 6, prmPrice: 3000, prmCost: 700,
            leg: 2, legPrice: 6000, legCost: 1500,
            hours: 6, recommended: true
        },
        {
            name: 'Aggressive',
            sub: 'å£²ä¸Šæœ€å¤§åŒ–ãƒ»é«˜å›è»¢',
            std: 16, stdPrice: 1400, stdCost: 280,
            prm: 8, prmPrice: 3200, prmCost: 750,
            leg: 3, legPrice: 6500, legCost: 1800,
            hours: 8, recommended: false
        }
    ];

    const grid = document.getElementById('plan-grid');
    grid.innerHTML = plans.map(p => {
        const cups = (p.std + p.prm + p.leg) * days;
        const rev = (p.std * p.stdPrice + p.prm * p.prmPrice + p.leg * p.legPrice) * days;
        const beanCost = (p.std * p.stdCost + p.prm * p.prmCost + p.leg * p.legCost) * days;
        const barista = p.hours * BARISTA_RATE * days;
        const misc = cups * MISC_PER_CUP;
        const totalCost = FIXED_TOTAL + beanCost + barista + misc;
        const profit = rev - totalCost;
        const margin = (profit / rev * 100).toFixed(1);
        const avgPrice = Math.round(rev / cups);

        return `
            <div class="plan-card ${p.recommended ? 'recommended' : ''}">
                <div class="plan-name">${p.name}</div>
                <div class="plan-sub">${p.sub}</div>
                <div class="plan-stat"><span>æ—¥è²©æ¯æ•°</span><span class="plan-stat-val">${p.std + p.prm + p.leg}æ¯</span></div>
                <div class="plan-stat"><span>æœˆé–“å£²ä¸Š</span><span class="plan-stat-val">${fmt(rev)}</span></div>
                <div class="plan-stat"><span>æœˆé–“ã‚³ã‚¹ãƒˆ</span><span class="plan-stat-val">${fmt(totalCost)}</span></div>
                <div class="plan-stat"><span>å¹³å‡å®¢å˜ä¾¡</span><span class="plan-stat-val">${fmt(avgPrice)}</span></div>
                <div class="plan-stat"><span>ãƒãƒªã‚¹ã‚¿ç¨¼åƒ</span><span class="plan-stat-val">${p.hours}h/æ—¥</span></div>
                <div class="plan-divider"></div>
                <div class="plan-stat"><span>å–¶æ¥­åˆ©ç›Šç‡</span><span class="plan-stat-val">${margin}%</span></div>
                <div class="plan-profit ${profit >= 0 ? 'positive' : 'negative'}">${fmt(profit)}/æœˆ</div>
                <div style="text-align:center;font-size:11px;color:#999;">å¹´é–“: ${fmt(profit * 12)}</div>
            </div>
        `;
    }).join('');

    // CFO conclusion
    const balanced = plans[1];
    const bCups = (balanced.std + balanced.prm + balanced.leg) * days;
    const bRev = (balanced.std * balanced.stdPrice + balanced.prm * balanced.prmPrice + balanced.leg * balanced.legPrice) * days;
    const bBeanCost = (balanced.std * balanced.stdCost + balanced.prm * balanced.prmCost + balanced.leg * balanced.legCost) * days;
    const bBarista = balanced.hours * BARISTA_RATE * days;
    const bMisc = bCups * MISC_PER_CUP;
    const bProfit = bRev - FIXED_TOTAL - bBeanCost - bBarista - bMisc;

    document.getElementById('cfo-conclusion').innerHTML = `
        <strong>Balanced Plan</strong>ã‚’æ¨å¥¨ã—ã¾ã™ã€‚æœˆé–“åˆ©ç›Š<strong>${fmt(bProfit)}</strong>ã€å¹´é–“<strong>${fmt(bProfit*12)}</strong>ã€‚<br><br>
        ãƒã‚¤ãƒ³ãƒˆã¯<span class="highlight">Legendaryæ ã®2æ¯/æ—¥</span>ã€‚ã“ã‚ŒãŒå£²ä¸Šã®25%ã‚’å ã‚ã‚‹ãŒã€è±†ã®åœ¨åº«ãƒªã‚¹ã‚¯ã¯å°‘ãªã„ã€‚
        Standardæ ã§å®‰å®šã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç¢ºä¿ã—ã¤ã¤ã€Premiumæ ã§ç²—åˆ©ã‚’ç¨¼ãæ§‹é€ ã€‚<br><br>
        <strong>ãƒªã‚¹ã‚¯ç®¡ç†:</strong> äºˆå‚™è²»Â¥100,000/æœˆã‚’ç¢ºä¿ã—ã¦ã„ã‚‹ã®ã§ã€å£²ä¸ŠãŒ20%è½ã¡ã¦ã‚‚2ãƒ¶æœˆã¯è€ãˆã‚‰ã‚Œã‚‹ã€‚
    `;

    document.getElementById('ceo-conclusion').innerHTML = `
        åŒæ„ã€‚ãƒ–ãƒ©ãƒ³ãƒ‰ã®ä¸–ç•Œè¦³ã‚’è€ƒãˆã‚‹ã¨ã€<strong>é‡ã‚ˆã‚Šè³ª</strong>ã§ã„ããŸã„ã€‚<br><br>
        Legendaryæ ã¯POPXã®IPã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¨è±†ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’çµ¡ã‚ãŸ<span class="highlight">ä½“é¨“å‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼</span>ã¨ã—ã¦æ‰“ã¡å‡ºã™ã€‚
        Â¥6,000ã®1æ¯ã«ã€Œã“ã®è±†ã®ç‰©èªã€ãŒã¤ã„ã¦ãã‚‹ã€‚ãã‚ŒãŒã†ã¡ã®å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆã€‚<br><br>
        ã¾ãšã¯Balancedã§3ãƒ¶æœˆèµ°ã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ãªãŒã‚‰Aggressiveæ–¹å‘ã«ã‚·ãƒ•ãƒˆã™ã‚‹ã‹åˆ¤æ–­ã—ã‚ˆã†ã€‚
    `;
}

function renderAnnual(days) {
    // Balanced plan annual projection with growth
    const baseStd = 12, basePrm = 6, baseLeg = 2;
    const stdP = 1500, prmP = 3000, legP = 6000;
    const stdC = 300, prmC = 700, legC = 1500;
    const hours = 6;

    let html = '<thead><tr><th>æœˆ</th><th>æ¯æ•°/æ—¥</th><th>å£²ä¸Š</th><th>ç·ã‚³ã‚¹ãƒˆ</th><th>åˆ©ç›Š</th><th>ç´¯è¨ˆåˆ©ç›Š</th></tr></thead><tbody>';
    let cumProfit = 0;

    for (let m = 1; m <= 12; m++) {
        // Growth: +1 cup/day every 3 months
        const growth = Math.floor((m - 1) / 3);
        const std = baseStd + growth;
        const prm = basePrm + Math.floor(growth * 0.5);
        const leg = baseLeg;
        const cupsDay = std + prm + leg;
        const cups = cupsDay * days;

        const rev = (std * stdP + prm * prmP + leg * legP) * days;
        const beanCost = (std * stdC + prm * prmC + leg * legC) * days;
        const barista = hours * BARISTA_RATE * days;
        const misc = cups * MISC_PER_CUP;
        const cost = FIXED_TOTAL + beanCost + barista + misc;
        const profit = rev - cost;
        cumProfit += profit;

        html += `<tr>
            <td>M${m}</td>
            <td>${cupsDay}æ¯</td>
            <td>${fmt(rev)}</td>
            <td>${fmt(cost)}</td>
            <td style="color:${profit>=0?'#059669':'#e74c3c'};font-weight:700;">${fmt(profit)}</td>
            <td style="font-weight:700;color:${cumProfit>=0?'#059669':'#e74c3c'};">${fmt(cumProfit)}</td>
        </tr>`;
    }
    html += '</tbody>';
    document.getElementById('annual-table').innerHTML = html;
}

// Initialize
calc();
</script>
</body>
</html>
